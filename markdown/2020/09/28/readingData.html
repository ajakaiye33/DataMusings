<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>How Pandas’s read_excel Saved My Life | DataPonderings</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="How Pandas’s read_excel Saved My Life" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Using Panda’s Read Excel Method." />
<meta property="og:description" content="Using Panda’s Read Excel Method." />
<link rel="canonical" href="https://ajakaiye33.github.io/DataMusings/markdown/2020/09/28/readingData.html" />
<meta property="og:url" content="https://ajakaiye33.github.io/DataMusings/markdown/2020/09/28/readingData.html" />
<meta property="og:site_name" content="DataPonderings" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-09-28T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"Using Panda’s Read Excel Method.","url":"https://ajakaiye33.github.io/DataMusings/markdown/2020/09/28/readingData.html","@type":"BlogPosting","headline":"How Pandas’s read_excel Saved My Life","dateModified":"2020-09-28T00:00:00-05:00","datePublished":"2020-09-28T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ajakaiye33.github.io/DataMusings/markdown/2020/09/28/readingData.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/DataMusings/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://ajakaiye33.github.io/DataMusings/feed.xml" title="DataPonderings" /><link rel="shortcut icon" type="image/x-icon" href="/DataMusings/images/favicon.ico"><link href="https://cdn.jsdelivr.net/npm/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/DataMusings/">DataPonderings</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/DataMusings/about/">About Me</a><a class="page-link" href="/DataMusings/search/">Search</a><a class="page-link" href="/DataMusings/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">How Pandas&#39;s read_excel Saved My Life</h1><p class="page-description">Using Panda's Read Excel Method.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-09-28T00:00:00-05:00" itemprop="datePublished">
        Sep 28, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      3 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/DataMusings/categories/#markdown">markdown</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#introduction">Introduction</a></li>
<li class="toc-entry toc-h3"><a href="#data-in-the-data-science-process">Data in the Data Science Process</a></li>
<li class="toc-entry toc-h3"><a href="#getting-data-into-jupyter-notebook">Getting Data into Jupyter Notebook</a></li>
</ul><p><img src="/images/pixabay.jpg" alt=""></p>
<h3 id="introduction">
<a class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h3>
<p>As common amongst the majority of individuals under the category of <em>Data Scientist by Accident</em>, once in a while, you come across what I call
‘moments of enlightenment’ which more or less upgrade your knowledge about the ‘tools of the trade’. I encountered one of such moments a couple of days ago. And since I just set up
a new blog courtesy of <a href="https://github.com/fastai/fastpages"><strong>fastai</strong></a>, I decided to relay my experience on how I entered Zen from discovering the usefulness and existence of pandas’s <code class="language-plaintext highlighter-rouge">read_html</code> methods!</p>

<h3 id="data-in-the-data-science-process">
<a class="anchor" href="#data-in-the-data-science-process" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data in the Data Science Process</h3>

<p>I make bold to say that the entire Data Science process revolves around one main resource: <strong>DATA</strong>. Data is an essential raw material in the manufacturing of <strong>Data Visualization</strong>
<strong>Models</strong>. While drawing on the analogy to drive home my point about data and its importance in the data Science pipeline, I’m very much aware that we don’t literally manufacture
anything rather a methodical transformation of inputs takes place. Thus raw data as an input is transformed into an output format that solves one problem or needs in the society.
No doubt data is very important in the data Science process, but how do we go about getting this data into our data science work environment?</p>

<h3 id="getting-data-into-jupyter-notebook">
<a class="anchor" href="#getting-data-into-jupyter-notebook" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting Data into Jupyter Notebook</h3>
<p>Before encountering Data Science, all I know about data and its handling was tied to one tool: <strong>MS EXCEL</strong>. Excel is an excellent tool in it own right but there come a time in your data handling experience when excel won’t just cut it. Most of my challenges with excel started manifesting when my data became larger. Lucky for me after narrating my
challenges on <strong>stackoverflow</strong> and exposing myself to public ridicule from some not-too-kind responders, I went away with the knowledge of the existence of PANDAS and JUPYTER
NOTEBOOK. Of course, with these new set of tools, I became the go-to-guy in the office for any data wrangling exercise and functions.
Majority of the data I use comes from scraping them off websites pages and transforming the data into <strong>csv</strong> format which I then read into the jupyter notbook for onward processing, exploration and analysis. Aside from the pandas’s <code class="language-plaintext highlighter-rouge">read_csv</code> method I knew from reading the documentation I could use <code class="language-plaintext highlighter-rouge">read_json</code>, <code class="language-plaintext highlighter-rouge">read_table</code>, <code class="language-plaintext highlighter-rouge">read_html</code> e.t.c to load data unto
jupyter notbook but never attempted using them until recently when I attended an online workshop, and the facilitator used the pandas’s <code class="language-plaintext highlighter-rouge">read_html</code> method.</p>

<p>### Can Life be this fun and Easy?
 My excitement knew no bounds when it occurred to me that I can improve productivity levels by just reading and loading data directly from websites pages especially when the data
 I’m interested in are housed within html’s table tags. For example, to scrape this <a href="https://covid19.ncdc.gov.ng/">site</a> normally, I will write the following code:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">def</span> <span class="nf">get_site_html</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">bs</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">.</span><span class="n">content</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">bs</span>
    <span class="k">except</span> <span class="nb">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">return</span> <span class="n">title</span>
<span class="k">def</span> <span class="nf">get_data</span><span class="p">():</span>
    <span class="n">site_html</span> <span class="o">=</span> <span class="n">get_site_html</span><span class="p">(</span><span class="s">'https://covid19.ncdc.gov.ng/'</span><span class="p">)</span>

    <span class="n">the_table</span> <span class="o">=</span> <span class="n">site_html</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="p">{</span><span class="s">'id'</span><span class="p">:</span> <span class="s">'custom1'</span><span class="p">})</span>
    <span class="n">head_table</span> <span class="o">=</span> <span class="n">the_table</span><span class="p">.</span><span class="n">thead</span><span class="p">.</span><span class="n">get_text</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
    <span class="c1"># print(the_table)
</span>    <span class="n">body_table</span> <span class="o">=</span> <span class="n">the_table</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'tr'</span><span class="p">)</span>
    <span class="n">table_head</span> <span class="o">=</span> <span class="n">body_table</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># print(table_head)
</span>    <span class="n">table_row</span> <span class="o">=</span> <span class="n">body_table</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="c1"># print(table_row)
</span>    <span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="n">ht</span><span class="p">.</span><span class="n">get_text</span><span class="p">()</span> <span class="k">for</span> <span class="n">ht</span> <span class="ow">in</span> <span class="n">table_head</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'th'</span><span class="p">)]</span>
    <span class="c1"># print(headings)
</span>    <span class="n">gey</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">table_row</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">find_all</span><span class="p">(</span><span class="s">'td'</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">table_row</span><span class="p">))]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">all_rows</span><span class="p">:</span>
        <span class="n">one_row</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">j</span><span class="p">:</span>
            <span class="n">one_row</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="n">get_text</span><span class="p">().</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">''</span><span class="p">))</span>
        <span class="n">gey</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">one_row</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">gey</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">headings</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></div>

<p>As much as I suspect the above sample code code be more concise, with pandas <code class="language-plaintext highlighter-rouge">read_html</code> method I can achieve the same purpose with just these few lines:</p>

<p><code class="language-plaintext highlighter-rouge">import pandas as pd
data = pd.read_html('https://covid19.ncdc.gov.ng/')
data.head()</code></p>

<p>I bet you can’t get more concise than that. These few lines have saved me alot of time and boosted my productivity to the roof. Hope you learnt a thing or two from this post.
Watch out for my next post. Bye!</p>

  </div><a class="u-url" href="/DataMusings/markdown/2020/09/28/readingData.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/DataMusings/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/DataMusings/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/DataMusings/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Data gymnastics... Enter Zen from there!.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://twitter.com/ajakzheddy" title="ajakzheddy"><svg class="svg-icon grey"><use xlink:href="/DataMusings/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
