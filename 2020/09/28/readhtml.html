<h1 id="how-pandass-read_excel-saved-my-life">How Pandas’s read_excel Saved My Life</h1>
<h3 id="introduction">Introduction</h3>
<p><img src="images/pixabay.jpg" alt="" />
As common amongst the majority of individuals under the category of <em>Data Scientist by Accident</em>, once in a while, you come across what I call 
‘moments of enlightenment’ which more or less upgrade your knowledge about the ‘tools of the trade’. I encountered one of such moments a couple of days ago. And since I just set up
a new blog courtesy of <a href="https://github.com/fastai/fastpages"><strong>fastai</strong></a>, I decided to relay my experience on how I entered Zen from discovering the usefulness and existence of pandas’s <code class="language-plaintext highlighter-rouge">read_html</code> methods!</p>

<h3 id="data-in-the-data-science-process">Data in the Data Science Process</h3>

<p>I make bold to say that the entire Data Science process revolves around one main resource: <strong>DATA</strong>. Data is an essential raw material in the manufacturing of <strong>Data Visualization</strong>
<strong>Models</strong>. While drawing on the analogy to drive home my point about data and its importance in the data Science pipeline, I’m very much aware that we don’t literally manufacture
anything rather a methodical transformation of inputs takes place. Thus raw data as an input is transformed into an output format that solves one problem or needs in the society. 
No doubt data is very important in the data Science process, but how do we go about getting this data into our data science work environment?</p>

<h3 id="getting-data-into-jupyter-notbook">Getting Data into Jupyter Notbook</h3>
<p>Before encountering Data Science, all I know about data and its handling was tied to one tool: <strong>MS EXCEL</strong>. Excel is an excellent tool in it own right but there come a time in your data handling experience when excel won’t just cut it. Most of my challenges with excel started manifesting when my data became larger. Lucky for me after narrating my 
challenges on <strong>stackoverflow</strong> and exposing myself to public ridicule from some not-too-kind responders, I went away with the knowledge of the existence of PANDAS and JUPYTER 
NOTEBOOK. Of course, with these new set of tools, I became the go-to-guy in the office for any data wrangling exercise and functions.
Majority of the data I use comes from scraping them off websites pages and transforming the data into <strong>csv</strong> format which I then read into the jupyter notbook for onward processing, exploration and analysis. Aside from the pandas’s <code class="language-plaintext highlighter-rouge">read_csv</code> method I knew from reading the documentation I could use <code class="language-plaintext highlighter-rouge">read_json</code>, <code class="language-plaintext highlighter-rouge">read_table</code>, <code class="language-plaintext highlighter-rouge">read_html</code> e.t.c to load data unto
jupyter notbook but never attempted using them until recently when I attended an online workshop, and the facilitator used the pandas’s <code class="language-plaintext highlighter-rouge">read_html</code> method.</p>

<p>### Can Life be this fun and easy?
 My excitement knew no bounds when it occurred to me that I can improve productivity levels by just reading and loading data directly from websites pages especially when the data 
 I’m interested in are housed within html’s table tags. For example, to scrape this <a href="https://covid19.ncdc.gov.ng/">site</a> normally, I will write the following code:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">def</span> <span class="nf">get_site_html</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">bs</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">.</span><span class="n">content</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">bs</span>
    <span class="k">except</span> <span class="nb">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">return</span> <span class="n">title</span>
<span class="k">def</span> <span class="nf">get_data</span><span class="p">():</span>
    <span class="n">site_html</span> <span class="o">=</span> <span class="n">get_site_html</span><span class="p">(</span><span class="s">'https://covid19.ncdc.gov.ng/'</span><span class="p">)</span>

    <span class="n">the_table</span> <span class="o">=</span> <span class="n">site_html</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="p">{</span><span class="s">'id'</span><span class="p">:</span> <span class="s">'custom1'</span><span class="p">})</span>
    <span class="n">head_table</span> <span class="o">=</span> <span class="n">the_table</span><span class="p">.</span><span class="n">thead</span><span class="p">.</span><span class="n">get_text</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
    <span class="c1"># print(the_table)
</span>    <span class="n">body_table</span> <span class="o">=</span> <span class="n">the_table</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'tr'</span><span class="p">)</span>
    <span class="n">table_head</span> <span class="o">=</span> <span class="n">body_table</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># print(table_head)
</span>    <span class="n">table_row</span> <span class="o">=</span> <span class="n">body_table</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="c1"># print(table_row)
</span>    <span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="n">ht</span><span class="p">.</span><span class="n">get_text</span><span class="p">()</span> <span class="k">for</span> <span class="n">ht</span> <span class="ow">in</span> <span class="n">table_head</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'th'</span><span class="p">)]</span>
    <span class="c1"># print(headings)
</span>    <span class="n">gey</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">table_row</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">find_all</span><span class="p">(</span><span class="s">'td'</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">table_row</span><span class="p">))]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">all_rows</span><span class="p">:</span>
        <span class="n">one_row</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">j</span><span class="p">:</span>
            <span class="n">one_row</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="n">get_text</span><span class="p">().</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">''</span><span class="p">))</span>
        <span class="n">gey</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">one_row</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">gey</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">headings</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></div>

<p>As much as I suspect the above sample code code be more concise, with pandas <code class="language-plaintext highlighter-rouge">read_html</code> method I can achieve the same purpose with just these few lines:</p>

<p><code class="language-plaintext highlighter-rouge">import pandas as pd 
data = pd.read_html('https://covid19.ncdc.gov.ng/')
data.head()</code></p>

<p>I bet you can’t get more concise than that. These few lines have saved me alot of time and boosted my productivity to the roof. Hope you learnt a thing or two from this post. 
Watch out for my next post. Bye!</p>

